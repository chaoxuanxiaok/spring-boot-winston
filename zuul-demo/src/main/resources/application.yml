
server:
  port: 10010 # \u7F51\u5173\u670D\u52A1\u7AEF\u53E3
spring:
  application:
    name: api-gateway #\u7F51\u5173\u670D\u52A1\u540D\u79F0

###############\u7F16\u5199\u8DEF\u7531\u89C4\u5219 1.0 ##########################################################
# \u7F51\u5173\u4F5C\u4E3A\u7EDF\u4E00\u7684\u5165\u53E3\uFF0C\u73B0\u5728\u518D\u8981\u8BBF\u95EEuser-service-demo\u7684\u670D\u52A1\uFF0C\u5C31\u5F97\u6309\u7167\u7F51\u5173\u7684\u89C4\u5219\u6765
# \u901A\u8FC7localhost:10010/user-service-demo/user/10 \u800C\u4E0D\u662F\u4E4B\u524D\u7684localhost:8081/user/10\u8BBF\u95EE
# zuul:
#  routes:
#    user-service:                          # \u8FD9\u91CC\u662F\u8DEF\u7531\u7684id\uFF0C\u968F\u610F\u586B\u5199
#      path: /user-service-demo/**          # \u6620\u5C04\u8DEF\u5F84\uFF0C\u5C06/user-service-demo/\u5F00\u5934\u7684\u8BF7\u6C42\u4EE3\u7406\u5230\u4E0B\u9762\u5B9E\u9645\u5730\u5740
#      url: http://127.0.0.1:8081           # \u6620\u5C04\u8DEF\u5F84\u5BF9\u5E94\u7684\u5B9E\u9645url\u5730\u5740

##############\u7F16\u5199\u8DEF\u7531\u89C4\u5219 2.0 ###########################################################
# \u4E0A\u9762\u7684\u914D\u7F6E\u6709\u95EE\u9898\u5417\uFF1F\u8DEF\u5F84\u5BF9\u5E94\u5730\u5740\u5199\u6B7B\u4E86\uFF0C\u82E5\u4E00\u4E2A\u670D\u52A1\u6709\u591A\u4E2A\u5B9E\u4F8B\uFF0C\u4E0A\u8FF0\u505A\u6CD5\u663E\u7136\u4E0D\u5408\u7406

eureka:
  client:
    service-url:
      defaultZone: http://127.0.0.1:10087/eureka  # \u6CE8\u518C\u4E2D\u5FC3\u7684\u5730\u5740
    registry-fetch-interval-seconds: 5         #  5\u79D2\u83B7\u53D6\u4E00\u6B21\u670D\u52A1\u5730\u5740\u5217\u8868
  instance:
    prefer-ip-address: true                     # \u83B7\u53D6\u5B9E\u4F8B\u7684hostname\u65F6\uFF0C\u8FD4\u56DEip\u800C\u4E0D\u662Fhost\u540D\u79F0
    ip-address: 127.0.0.1                        # \u6307\u5B9A\u81EA\u5DF1\u7684ip\u4FE1\u606F\uFF0C\u82E5\u4E0D\u6307\u5B9A\u4F1A\u81EA\u52A8\u5BFB\u627E

# \u6BD4\u8F83\u5E38\u89C4\u7684\u5199\u6CD5
zuul:
  prefix: /api    # \u6DFB\u52A0\u8DEF\u7531\u524D\u7F00  \u52A0\u4E86\u524D\u7F00\u4EE5\u540E\uFF0C\u4E4B\u540E\u53D1\u8D77\u8BF7\u6C42\u90FD\u8981\u6709\u524D\u7F00\u5F00\u5934 /api/user-service-demo/user
  routes:
    user-service:                               # \u8FD9\u91CC\u662F\u8DEF\u7531\u7684id\uFF0C\u968F\u610F\u586B\u5199
      path: /user-service-demo/**
      serviceId: user-service-demo              # \u533A\u522B\u4E8E\u4E0A\u9762\u76F4\u63A5\u6307\u5B9A\u5730\u5740\uFF0C\u8FD9\u91CC\u6307\u5B9A\u670D\u52A1\u540D\u79F0
  retryable: true                              # \u5141\u8BB8\u91CD\u8BD5

# \u7B80\u5316\u7684\u5199\u6CD5\uFF0C\u901A\u5E38\u60C5\u51B5\uFF0C\u8DEF\u7531id\u4E0EserviceId\u4F1A\u5199\u6210\u4E00\u81F4
# \u6240\u4EE5\u4E0A\u9762\u7684\u5E38\u89C4\u5199\u6CD5 \u53EF\u4EE5\u7528 zuul.routes.<serviceId>=<path>
#zuul:
#  routes:
#    user-service: /user-service-demo/**

# \u9ED8\u8BA4\u8DEF\u7531\u914D\u7F6E\uFF0C\u4E00\u5207\u670D\u52A1\u7684\u6620\u5C04\u8DEF\u5F84\u5C31\u662F\u670D\u52A1\u540D\u672C\u8EAB--------\u9664\u975E\u9700\u8981\u4E2A\u6027\u5316\uFF0C\u5426\u5219\u4E0A\u8FF0\u5199\u6CD5\u4E0D\u914D\u7F6E\u4E5F\u4F1A\u751F\u6548

################ Zuul\u9ED8\u8BA4\u96C6\u6210Ribbon\u548CHystrix ################################################################
# \u8D85\u65F6\u7B56\u7565\u90FD\u662F\u9ED8\u8BA4\u503C\uFF0C\u5F88\u5BB9\u6613\u89E6\u53D1\uFF0C\u9700\u8981\u624B\u52A8\u4FEE\u6539
ribbon:
  ConnectTimeout: 250                    #  \u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4 ms
  ReadTimeout: 2000                      #  \u901A\u4FE1\u8D85\u65F6\u65F6\u95F4 ms \uFF0C\u6570\u636E\u8BFB\u53D6\u65F6\u95F4\uFF0C\u8981\u5C0F\u4E8EHystrix\u7684\u8D85\u65F6\u65F6\u95F4
  OkToRetryOnAllOperations: true       #  \u662F\u5426\u5BF9\u6240\u6709\u64CD\u4F5C\u91CD\u8BD5
  MaxAutoRetriesNextServer: 2          #  \u540C\u4E00\u670D\u52A1\u4E0D\u540C\u5B9E\u4F8B\u7684\u91CD\u8BD5\u6B21\u6570
  MaxAutoRetries: 1                     #  \u540C\u4E00\u5B9E\u4F8B\u7684\u91CD\u8BD5\u6B21\u6570
hystrix:
  command:
    default:
      execution:
        isolation:
          thread:
            timeoutInMillisecond: 6000  # \u7194\u65AD\u65F6\u957F6000\u6BEB\u79D2

